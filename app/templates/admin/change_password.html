{% extends 'admin/master.html' %}

{% block body %}
  <div class="container mt-4">
    <h2 class="mb-3">修改密码</h2>
    <p class="text-muted">为确保安全，新密码至少需要 8 个字符，并且不建议与旧密码相同。</p>

    {% with messages = get_flashed_messages(with_categories=True) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="row">
      <div class="col-md-6">
        <form method="POST" action="{{ url_for('admin.change_password') }}">
          {{ form.hidden_tag() }}

          <div class="form-group">
            {{ form.current_password.label(class_="font-weight-bold") }}
            {{ form.current_password(class_='form-control' + (' is-invalid' if form.current_password.errors else ''), autocomplete='current-password') }}
            {% for error in form.current_password.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <div class="form-group">
            {{ form.new_password.label(class_="font-weight-bold") }}
            {{ form.new_password(class_='form-control' + (' is-invalid' if form.new_password.errors else ''), autocomplete='new-password') }}
            {% for error in form.new_password.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <div class="form-group">
            {{ form.confirm_new_password.label(class_="font-weight-bold") }}
            {{ form.confirm_new_password(class_='form-control' + (' is-invalid' if form.confirm_new_password.errors else ''), autocomplete='new-password') }}
            {% for error in form.confirm_new_password.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          {{ form.submit(class_="btn btn-primary") }}
        </form>
      </div>
    </div>
  </div>
{% endblock %}
